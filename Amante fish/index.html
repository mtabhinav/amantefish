<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Amante Fishes â€” Order via WhatsApp</title>
<style>
  :root{
    --sea-1:#023e8a; --sea-2:#0077b6; --sea-3:#0096c7;
    --accent:#ff6b6b; --card:#ffffff;
    --bg: linear-gradient(180deg,#e6f7fb 0%, #f4fbff 100%);
    --glass: rgba(255,255,255,0.75);
  }
  *{box-sizing:border-box}
  body{
    margin:0;
    font-family:Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
    background:var(--bg);
    color:#042028;
    -webkit-font-smoothing:antialiased;
    -moz-osx-font-smoothing:grayscale;
    line-height:1.35;
  }

  header{
    background: linear-gradient(135deg,var(--sea-1), var(--sea-2));
    color:#fff;
    padding:26px 14px;
    text-align:center;
    position:relative;
    overflow:hidden;
  }
  header .brand{display:flex;gap:12px;align-items:center;justify-content:center;flex-wrap:wrap;}
  header img.logo{width:84px;height:84px;object-fit:cover;border-radius:10px;border:3px solid rgba(255,255,255,0.12);box-shadow:0 8px 22px rgba(2,46,76,0.25);}
  header h1{margin:8px 0 2px;font-size:20px;letter-spacing:0.6px}
  header p.sub{margin:0;font-size:13px;opacity:0.95}

  .wrap{max-width:1100px;margin:18px auto;padding:0 14px}

  .tabs{display:flex;gap:8px;flex-wrap:wrap;margin:14px 0;}
  .tab-btn{background:var(--glass);border:0;padding:10px 12px;border-radius:10px;cursor:pointer;font-weight:600;color:var(--sea-1);box-shadow:0 4px 14px rgba(2,46,76,0.06);}
  .tab-btn.active{background: linear-gradient(90deg, rgba(255,255,255,0.06), rgba(255,255,255,0.02)); color:white; box-shadow:0 10px 30px rgba(2,46,76,0.20); border:1px solid rgba(255,255,255,0.08);}

  .panel{display:flex;gap:18px;align-items:flex-start;margin-top:10px;}
  .left{flex:1 1 680px;}
  .right{width:360px;min-width:260px;position:sticky;top:18px;height:fit-content;}

  .grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(260px,1fr));gap:14px;}
  .card{background:var(--card);border-radius:12px;overflow:hidden;box-shadow:0 8px 20px rgba(2,46,76,0.06);display:flex;flex-direction:column;}
  .thumb{width:100%;height:150px;object-fit:cover;display:block;}
  .card-body{padding:12px 12px 14px;display:flex;flex-direction:column;gap:8px}
  .fish-name{font-weight:700;color:var(--sea-2);font-size:15px}
  .price-row{font-size:13px;color:#0b3b47;display:flex;gap:8px;flex-wrap:wrap;align-items:center}
  .price-chip{background:rgba(0,0,0,0.04);padding:6px 8px;border-radius:8px;font-weight:600}
  .controls{display:flex;gap:8px;align-items:center;flex-wrap:wrap;justify-content:space-between}
  .variant-select{padding:6px 8px;border-radius:8px;border:1px solid #dfeff2;background:white;font-size:13px}
  .qty{width:86px;padding:6px 8px;border-radius:8px;border:1px solid #dfeff2;background:white;text-align:center;font-size:14px}
  .add-mini{background:var(--sea-3);color:white;padding:8px 10px;border-radius:10px;border:0;cursor:pointer;font-weight:700}

  .summary{background: linear-gradient(180deg, rgba(0,119,182,0.04), rgba(0,119,182,0.02));border:1px solid rgba(0,119,182,0.06);padding:14px;border-radius:12px;font-size:14px;color:#073642;}
  .summary h4{margin:0 0 8px}
  .summary-list{max-height:360px;overflow:auto;padding-right:6px}
  .summary-row{display:flex;justify-content:space-between;padding:8px 0;border-bottom:1px dashed rgba(3,46,76,0.04)}
  .total-row{display:flex;justify-content:space-between;font-weight:800;padding-top:12px;margin-top:8px;border-top:2px solid rgba(3,46,76,0.04)}
  .order-btn{display:block;width:100%;background:linear-gradient(90deg,var(--sea-3),var(--sea-2));color:white;padding:12px;border-radius:10px;border:0;font-weight:800;margin-top:12px;cursor:pointer;font-size:15px;box-shadow:0 10px 30px rgba(0,119,182,0.18);}
  .clear-btn{background:white;color:var(--sea-2);border:1px solid rgba(0,119,182,0.06);padding:8px;border-radius:8px;width:100%;cursor:pointer;margin-top:8px;font-weight:700}

  footer{margin-top:28px;padding:18px 0;text-align:center;color:#03506f;font-size:13px}

  .whats-fab{position:fixed;right:18px;bottom:18px;width:58px;height:58px;border-radius:50%;background:#25D366;display:flex;align-items:center;justify-content:center;cursor:pointer;z-index:9999;box-shadow:0 12px 30px rgba(37,211,102,0.18);}
  .whats-fab img{width:34px;height:34px;display:block}

  @media(max-width:980px){.panel{flex-direction:column}.right{position:static;width:100%}}
  @media(max-width:520px){header h1{font-size:18px}.thumb{height:140px}.qty{width:68px}}
</style>
</head>
<body>
<header style="background: linear-gradient(135deg, #0077b6, #00b4d8); color: white; text-align: center; padding: 30px 10px;"></style=>
  <div class="brand">
    <img class="logo" src="Image/Amantelogo.jpg" alt="Amante Fishes"  style="max-width: 150px; border-radius: 12px; margin-bottom: 10px;">
    <div>
      <h1 style="font-size: 48px; font-weight: 800; margin: 10px 0;">AMANTE FISHES</h1>
      <p style="font-size: 20px; margin: 0;">Fresh from Billingsgate Market â€” Next Day Delivery Â· Kerala-style cleaning & packing</p>
      <p style="font-size: 20px; margin: 0;">Canary Wharf | East Ham | Whitechapel | Poplar | Stratford(5km radius) </p>
    </div>
  </div>
  <svg style="position:absolute;left:0;bottom:-1px;width:100%;" viewBox="0 0 1440 100" preserveAspectRatio="none"><path fill="rgba(255,255,255,0.04)" d="M0 0h1440v30c-70 20-140 35-210 35-70 0-140-15-210-35C900 15 830 0 720 0c-110 0-180 15-300 30C300 55 230 70 140 70 70 70 35 65 0 60z"></path></svg>
</header>

<main class="wrap">
  <div class="tabs" id="tabs"></div>

  <div class="panel">
    <div class="left">
      <div id="contentArea"></div>
    </div>

    <aside class="right">
      <div class="summary">
        <h4>Your Order</h4>
        <div class="summary-list" id="summaryList"><div style="color:#055a66">No items selected yet.</div></div>
        <div class="total-row" style="margin-top:8px"><div>Total</div><div id="grandTotal">Â£0.00</div></div>
        <button id="orderOnWhatsApp" class="order-btn">Order on WhatsApp</button>
        <button id="clearAll" class="clear-btn">Clear Selection</button>
        <small style="display:block;margin-top:8px;color:#024b56">Orders go to WhatsApp: +44 7810 038751</small>
      </div>
    </aside>
  </div>

  <footer>Â© 2025 Amante Fishes Â· Fresh Fish Delivery Â· Contact: +44 7810 038751</footer>
</main>

<div class="whats-fab" id="fab" title="Chat on WhatsApp">
  <img src="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' width='24' height='24'><path fill='white' d='M20.52 3.48A11.94 11.94 0 0 0 12 .5 11.94 11.94 0 0 0 3.48 3.48C.98 6 0 9.22 0 12.5 0 14.26.54 15.9 1.54 17.3L0 24l6.86-1.78A11.94 11.94 0 0 0 12.5 24c3.28 0 6.5-1 9.02-3.52A11.94 11.94 0 0 0 24 12.5 11.94 11.94 0 0 0 20.52 3.48z'/></svg>" alt="wa">
</div>

<script>
/* Full menu taken from the provided image, prices shown in GBP (Â£). */
const MENU = [
  {
    cat: "Popular Kerala Choices",
    items: [
      { name:"Anchovy (Kozhuva)", variants:[ {label:"Cleaned", price:15}, {label:"Uncleaned", price:13} ], img:"https://static.freshtohome.com/cdn-cgi/image/width=600/https://static.freshtohome.com/media/catalog/product/a/n/anchovy-anchovyfishwhole_2.jpg" },
      { name:"Indian Sardine (Chaala)", variants:[ {label:"Cleaned (subject to availability)", price:13} ], img:"https://c8.alamy.com/comp/M5489B/single-sardine-fish-on-a-white-background-M5489B.jpg" },
      { name:"Sardine (Mathi) - 3kg", variants:[ {label:"3kg", price:15}, {label:"Cleaned 3kg", price:20} ], img:"https://freshcuts4u.com/cdn/shop/files/freepik-export-202410241520258zIo.jpg?v=1729783235&width=1920" },
      { name:"Indian Mackerel (Ayala)", variants:[ {label:"Uncleaned", price:13}, {label:"Cleaned", price:15} ], img:"https://freshkerala.co.in/wp-content/uploads/2020/10/mackerel-fish.jpg" },
      { name:"Kingfish (Aikoora / Neimeen)", variants:[ {label:"Uncleaned", price:15.5}, {label:"Cleaned", price:18} ], img:"https://freshkerala.co.in/wp-content/uploads/2020/10/King-Fish1.jpg" },
      { name:"Pearl Spot (Karimeen)", variants:[ {label:"Uncleaned", price:13}, {label:"Cleaned", price:16} ], img:"https://static.freshtohome.com/cdn-cgi/image/width=600/https://static.freshtohome.com/media/catalog/product/p/e/pearl_spot_karimeen_large_whole_2.jpg" }
    ]
  },

  {
    cat: "Premium & Sea Fishes",
    items: [
      { name:"Japanese Threadfin Bream (Kilimeen)", variants:[ {label:"Uncleaned", price:13.5}, {label:"Cleaned", price:16} ], img:"https://wholesomeseafood.pk/wp-content/uploads/2025/06/Buy-Fresh-Japanese-Threadfin-Bream-Chakori-Online-in-Pakistan-Cash-on-Delivery.webp" },
      { name:"Trevally (Vatta)", variants:[ {label:"Uncleaned", price:13}, {label:"Cleaned", price:15.5} ], img:"https://static.freshtohome.com/cdn-cgi/image/width=600/https://static.freshtohome.com/media/catalog/product/t/r/trevalli_large_whole.jpg" },
      { name:"Barramundi (Kalanji)", variants:[ {label:"Uncleaned", price:14.5}, {label:"Cleaned", price:17} ], img:"https://freshhookfish.com/uploads/all/Tw8fOQQWwzZuWwzt7oPJPLdKzwxjhIRY9Y5aRa6q.jpg" },
      { name:"Red Snapper (Chembally)", variants:[ {label:"Uncleaned", price:16}, {label:"Cleaned", price:18} ], img:"https://static.freshtohome.com/cdn-cgi/image/width=600/https://static.freshtohome.com/media/catalog/product/r/e/red-snapper_big.jpg" },
      { name:"Pony Thithiny", variants:[ {label:"Standard", price:15} ], img:"https://www.clovegarden.com/ingred/img/sf_pony26g.jpg" }
    ]
  },

  {
    cat: "Pomfrets & Special Varieties",
    items: [
      { name:"Black Pomfret (Aavoli)", variants:[ {label:"Standard", price:16} ], img:"https://static.freshtohome.com/cdn-cgi/image/width=600/https://static.freshtohome.com/media/catalog/product/b/l/black_pomfret_whole_2.jpg" },
      { name:"Silver Pomfret (Velutha Aavoli)", variants:[ {label:"Size dependent (approx)", price:21} ], img:"https://static.freshtohome.com/cdn-cgi/image/width=600/https://static.freshtohome.com/media/catalog/product/s/i/silver_pomfret_whole_2_3_2.jpg" },
      { name:"Golden Pomfret", variants:[ {label:"Standard", price:12} ], img:"https://frozenfish.direct/wp-content/uploads/2018/10/Golden-Pomfret-scaled.jpeg" },
      { name:"Barracuda (Sheelavu)", variants:[ {label:"Standard", price:14} ], img:"https://www.nuste.in/cdn/shop/files/barracudafishF.jpg?v=1710762912" },
      { name:"Ribbon Fish (Vala Meen)", variants:[ {label:"Standard", price:13.5} ], img:"https://static.freshtohome.com/cdn-cgi/image/width=600/https://static.freshtohome.com/media/catalog/product/r/i/ribbon_fish_whole_6.5g_2.jpg" }
    ]
  },

  {
    cat: "Shellfish & Crustaceans",
    items: [
      { name:"Squid (Koonthal)", variants:[ {label:"Standard", price:15.5} ], img:"https://static.freshtohome.com/cdn-cgi/image/width=600/https://static.freshtohome.com/media/catalog/product/5/b/5b3a85125d-edit_1_2.jpg" },
      { name:"Needle Squid", variants:[ {label:"Standard", price:15} ], img:"https://www.brglobaltrade.com/wp-content/uploads/2024/09/Frozen-Needle-Squid-Seafood-Supplier-From-India.webp" },
      { name:"Blue Crab", variants:[ {label:"Per kg", price:15} ], img:"https://www.shutterstock.com/image-photo/blue-crab-seaside-wild-nature-600nw-2262310053.jpg" },
      { name:"Brown Crab", variants:[ {label:"Per kg", price:15} ], img:"https://www.directseafoods.co.uk/wp-content/uploads/Crab.jpg" },
      { name:"Mud Crab (size varies)", variants:[ {label:"Based on size", price:0} ], img:"https://www.bayhawk.in/wp-content/uploads/2022/06/Mangrove-Crab.jpg" },
      { name:"Clam Mest (Katka)", variants:[ {label:"Standard", price:10} ], img:"https://static.freshtohome.com/cdn-cgi/image/width=600/https://static.freshtohome.com/media/catalog/product/c/l/clam_meat_large.jpg" },
      { name:"Mussels (Kallumatkaya)", variants:[ {label:"Market Price", price:0} ], img:"https://static.freshtohome.com/cdn-cgi/image/width=600/https://static.freshtohome.com/media/catalog/product/g/r/green-mussels-boiled_uncleaned.jpg" },
      { name:"Prawn (30/40 Jumbo)", variants:[ {label:"Per kg", price:12} ], img:"https://packmymeat.com/wp-content/uploads/2024/01/20240101_230636.png" },
      { name:"Red Lobster â€“ Live / Dead", variants:[ {label:"Contact for price", price:0} ], img:"https://pinetreeseafood.com/wp-content/uploads/2021/07/how-to-cook-maine-lobster-3-ways-1024x538.jpg" }
    ]
  },

  {
    cat: "Other Fresh Varieties",
    items: [
      { name:"Sole Fish (Manathal)", variants:[ {label:"Standard", price:14.5} ], img:"https://www.freshtohome.com/blog/wp-content/uploads/2016/11/Sole-Fish-Manthal-Repti-Large.jpg" },
      { name:"Sole (Oola Meen) - Steaks", variants:[ {label:"Steaks", price:14} ], img:"https://m.media-amazon.com/images/I/61OnoK4anpL._AC_UF894,1000_QL80_.jpg" },
      { name:"Curry Cut", variants:[ {label:"Standard", price:16} ], img:"https://assets.tendercuts.in/product/S/F/bddaea5d-5f75-4b64-a84d-076e7bba7761.webp" },
      { name:"Hamour", variants:[ {label:"Uncleaned", price:13}, {label:"Cleaned", price:17} ], img:"https://static.freshtohome.com/cdn-cgi/image/width=600/https://static.freshtohome.com/media/catalog/product/g/r/grouper_medium_3.jpg" },
      { name:"Rabbit Fish (Otti)", variants:[ {label:"Standard", price:13} ], img:"https://static.freshtohome.com/cdn-cgi/image/width=600/https://static.freshtohome.com/media/catalog/product/r/a/rabbit-fish-whole.jpg" },
      { name:"Jack Fish (Ayala Para)", variants:[ {label:"Standard", price:15.5} ], img:"https://static.freshtohome.com/cdn-cgi/image/width=600/https://static.freshtohome.com/media/catalog/product/h/o/horse_mackerel_whole.jpg" },
      { name:"Baby Jack", variants:[ {label:"Standard", price:13} ], img:"https://readingqualityfish.co.uk/cdn/shop/products/Jackfish.png?v=1605878295" },
      { name:"Shark (Sraaavu) - Cleaned", variants:[ {label:"Cleaned", price:9} ], img:"https://www.nuste.in/cdn/shop/files/SharkFish.jpg?v=1710762746" },
      { name:"Milk Shark", variants:[ {label:"Standard", price:14} ], img:"https://upload.wikimedia.org/wikipedia/commons/thumb/8/8c/Rhizoprionodon_acutus_mangalore.jpg/1200px-Rhizoprionodon_acutus_mangalore.jpg" },
      { name:"Salmon â€“ Cleaned", variants:[ {label:"Cleaned", price:13.5} ], img:"https://m.media-amazon.com/images/I/61Q0r8bwOBL.jpg" },
      { name:"Indian Salmon â€“ Uncleaned", variants:[ {label:"Uncleaned", price:15} ], img:"https://freshkatch.in/cdn/shop/products/Solaman.jpg?v=1642692584" },
      { name:"Grey Mullet", variants:[ {label:"Standard", price:15} ], img:"https://static.freshtohome.com/cdn-cgi/image/width=600/https://static.freshtohome.com/media/catalog/product/g/r/grey_mullet_whole_1_2.jpg" },
      { name:"Lady Fish (Kairthiran)", variants:[ {label:"Standard", price:16} ], img:"https://www.bayhawk.in/wp-content/uploads/2022/06/Lady-Fish.jpg" },
      { name:"Tuna", variants:[ {label:"Uncleaned", price:13.5}, {label:"Cleaned", price:16.5} ], img:"https://cdn.store-assets.com/s/356189/i/19429753.jpg?width=1024" },
      { name:"Yellowfin Tuna", variants:[ {label:"Uncleaned", price:13}, {label:"Cleaned", price:16} ], img:"https://www.bbassets.com/media/uploads/p/l/40227771_2-fresho-yellowfin-tuna-fish-succulent-high-quality-fresh.jpg" },
      { name:"Sea Bass / Sea Bream", variants:[ {label:"Market Price", price:0} ], img:"https://5.imimg.com/data5/CA/XQ/MY-31323389/chilean-seabass-fish-500x500.jpg" }
    ]
  }
];

/* WhatsApp phone number in international format without '+' */
const PHONE = "447810038751";

/* Format GBP */
function fmtGBP(n){
  if (Number(n) === 0) return "â€”";
  return "Â£" + Number(n).toFixed(2);
}

/* Persistent cart state (keeps selections while switching tabs) */
let cartState = JSON.parse(localStorage.getItem('amante_cart') || '{}');

/* Save cartState to localStorage for persistence across refresh */
function saveCart(){
  localStorage.setItem('amante_cart', JSON.stringify(cartState));
}

/* UI elements */
const tabsEl = document.getElementById('tabs');
const contentArea = document.getElementById('contentArea');

/* Render tab buttons */
MENU.forEach((section, idx) => {
  const btn = document.createElement('button');
  btn.className = 'tab-btn' + (idx===0 ? ' active' : '');
  btn.textContent = section.cat;
  btn.dataset.idx = idx;
  btn.addEventListener('click', () => {
    document.querySelectorAll('.tab-btn').forEach(b=>b.classList.remove('active'));
    btn.classList.add('active');
    renderSection(idx);
    window.scrollTo({top:0, behavior:'smooth'});
  });
  tabsEl.appendChild(btn);
});

/* Render a section (category). When rendering, restore any saved qty/variant from cartState. */
function renderSection(idx){
  const sec = MENU[idx];
  contentArea.innerHTML = '';
  const grid = document.createElement('div');
  grid.className = 'grid';

  sec.items.forEach((it, ii) => {
    const key = `${idx}_${ii}`; // unique key for this item
    const saved = cartState[key] || { qty: 0, variant: 0 };

    const card = document.createElement('div'); card.className = 'card';
    const img = document.createElement('img'); img.className = 'thumb'; img.src = it.img; img.alt = it.name;
    const bd = document.createElement('div'); bd.className = 'card-body';

    const name = document.createElement('div'); name.className = 'fish-name'; name.textContent = it.name;
    bd.appendChild(name);

    const priceRow = document.createElement('div'); priceRow.className = 'price-row';
    it.variants.forEach(v=>{
      const chip = document.createElement('div'); chip.className = 'price-chip';
      chip.textContent = `${v.label}: ${fmtGBP(v.price)}`;
      priceRow.appendChild(chip);
    });
    bd.appendChild(priceRow);

    const ctrl = document.createElement('div'); ctrl.className = 'controls';

    // variant select when multiple variants exist, otherwise display single label
    let sel = null;
    if(it.variants.length > 1){
      sel = document.createElement('select'); sel.className = 'variant-select';
      it.variants.forEach((v, i) => {
        const o = document.createElement('option'); o.value = i; o.textContent = `${v.label} â€” ${fmtGBP(v.price)}`;
        sel.appendChild(o);
      });
      sel.value = saved.variant ?? 0;
      sel.dataset.section = idx; sel.dataset.item = ii;
      ctrl.appendChild(sel);
    } else {
      const sp = document.createElement('div'); sp.style.fontSize='13px'; sp.style.color='#064b4f'; sp.textContent = `${it.variants[0].label} â€” ${fmtGBP(it.variants[0].price)}`;
      ctrl.appendChild(sp);
    }

    // quantity input
    const qty = document.createElement('input'); qty.type = 'number'; qty.min = '0'; qty.placeholder = 'Qty'; qty.className = 'qty';
    qty.dataset.section = idx; qty.dataset.item = ii;
    qty.value = saved.qty || '';
    ctrl.appendChild(qty);

    // +Add quick button
// Create Add button
const addBtn = document.createElement('button');
addBtn.textContent = 'Add';
addBtn.className = 'add-btn';
addBtn.style.background = '#2196F3'; // light blue color
addBtn.style.color = '#fff';
addBtn.style.border = 'none';
addBtn.style.padding = '6px 16px';
addBtn.style.borderRadius = '20px';
addBtn.style.cursor = 'pointer';
addBtn.style.fontWeight = '600';
addBtn.style.transition = 'all 0.3s ease';

ctrl.appendChild(addBtn);

// Function to create + / - control
function createQtyControl() {
  const wrapper = document.createElement('div');
  wrapper.className = 'qty-control';
  wrapper.style.display = 'flex';
  wrapper.style.alignItems = 'center';
  wrapper.style.border = '1px solid #2196F3';
  wrapper.style.borderRadius = '20px';
  wrapper.style.padding = '2px 8px';
  wrapper.style.color = '#2196F3';
  wrapper.style.gap = '10px';
  wrapper.style.transition = 'all 0.3s ease';

  const dec = document.createElement('button');
  dec.textContent = 'â€“';
  dec.className = 'qty-btn';
  dec.style.background = 'transparent';
  dec.style.border = 'none';
  dec.style.color = '#2196F3';
  dec.style.fontSize = '16px';
  dec.style.cursor = 'pointer';
  dec.style.fontWeight = '600';

  const num = document.createElement('span');
  num.textContent = '1';
  num.className = 'qty-num';
  num.style.fontWeight = '600';
  num.style.minWidth = '20px';
  num.style.textAlign = 'center';

  const inc = document.createElement('button');
  inc.textContent = '+';
  inc.className = 'qty-btn';
  inc.style.background = 'transparent';
  inc.style.border = 'none';
  inc.style.color = '#2196F3';
  inc.style.fontSize = '16px';
  inc.style.cursor = 'pointer';
  inc.style.fontWeight = '600';

  // Button actions
  inc.addEventListener('click', () => {
    const current = Number(num.textContent);
    num.textContent = current + 1;
    qty.value = current + 1;
    saveState(idx, ii, qty.value, sel ? sel.value : 0);
    updateSummary();
  });

  dec.addEventListener('click', () => {
    const current = Number(num.textContent);
    if (current > 1) {
      num.textContent = current - 1;
      qty.value = current - 1;
      saveState(idx, ii, qty.value, sel ? sel.value : 0);
      updateSummary();
    } else {
      // Go back to Add button
      ctrl.removeChild(wrapper);
      ctrl.appendChild(addBtn);
      qty.value = 0;
      saveState(idx, ii, 0, sel ? sel.value : 0);
      updateSummary();
    }
  });

  wrapper.appendChild(dec);
  wrapper.appendChild(num);
  wrapper.appendChild(inc);
  return wrapper;
}

// When Add button is clicked
addBtn.addEventListener('click', () => {
  qty.value = 1;
  saveState(idx, ii, 1, sel ? sel.value : 0);
  updateSummary();
  ctrl.removeChild(addBtn);
  const qtyControl = createQtyControl();
  ctrl.appendChild(qtyControl);
});




    // Attach listeners to save changes into cartState (persist across tabs)
    if(sel){
      sel.addEventListener('change', ()=> {
        saveState(idx, ii, qty.value, sel.value);
        updateSummary();
      });
    }
    qty.addEventListener('input', ()=> {
      saveState(idx, ii, qty.value, sel ? sel.value : 0);
      updateSummary();
    });

    bd.appendChild(ctrl);
    card.appendChild(img);
    card.appendChild(bd);
    grid.appendChild(card);
  });

  contentArea.appendChild(grid);
  updateSummary();
}

/* Save single item state to cartState and localStorage */
function saveState(section, item, qty, variant){
  const key = `${section}_${item}`;
  const q = Number(qty) || 0;
  const v = Number(variant) || 0;
  if(q <= 0){
    delete cartState[key];
  } else {
    cartState[key] = { qty: q, variant: v };
  }
  saveCart();
}

/* Get current selections from cartState in structured form for summary & message */
function getSelections(){
  const sels = [];
  for(const key in cartState){
    if(!cartState.hasOwnProperty(key)) continue;
    const parts = key.split('_');
    if(parts.length !== 2) continue;
    const sidx = Number(parts[0]), iidx = Number(parts[1]);
    const item = MENU[sidx].items[iidx];
    if(!item) continue;
    const qty = cartState[key].qty || 0;
    if(qty <= 0) continue;
    const variantIndex = cartState[key].variant || 0;
    const variant = item.variants[variantIndex] || item.variants[0];
    const unit = Number(variant.price) || 0;
    const subtotal = +(unit * qty);
    sels.push({
      section: MENU[sidx].cat,
      name: item.name,
      variantLabel: variant.label,
      unit,
      qty,
      subtotal
    });
  }
  return sels;
}

/* Update order summary on the right and total */
function updateSummary(){
  const sels = getSelections();
  const list = document.getElementById('summaryList');
  list.innerHTML = '';
  if(sels.length === 0){
    list.innerHTML = '<div style="color:#055a66">No items selected yet.</div>';
    document.getElementById('grandTotal').textContent = 'Â£0.00';
    return;
  }
  let total = 0;
  sels.forEach(s => {
    total += s.subtotal;
    const row = document.createElement('div'); row.className = 'summary-row';
    const left = document.createElement('div'); left.style.minWidth = '0';
    left.innerHTML = `<div style="font-weight:700;color:#033a4a">${s.name}</div><div style="font-size:13px;color:#055a66">${s.variantLabel} Â· Qty: ${s.qty}</div>`;
    const right = document.createElement('div'); right.style.fontWeight='700'; right.textContent = (s.unit > 0) ? 'Â£' + s.subtotal.toFixed(2) : 'Contact';
    row.appendChild(left); row.appendChild(right);
    list.appendChild(row);
  });
  document.getElementById('grandTotal').textContent = 'Â£' + total.toFixed(2);
}

/* Build WhatsApp message text (encoded) */
function buildWhatsAppMessage(){
  const sels = getSelections();
  if(sels.length === 0) return null;
  const lines = [];
  lines.push('Hello Amante Fishes! ðŸŸ');
  lines.push('I would like to order the following:');
  lines.push('');
  sels.forEach((s, i) => {
    const unitStr = s.unit > 0 ? ` (Â£${s.unit.toFixed(2)} each)` : '';
    const subStr = s.unit > 0 ? ` â€” Subtotal Â£${s.subtotal.toFixed(2)}` : ' â€” Price to be confirmed';
    lines.push(`${i+1}. ${s.name} â€” ${s.variantLabel} â€” Qty: ${s.qty}${unitStr}${subStr}`);
  });
  lines.push('');
  lines.push(`Total: Â£${getSelections().reduce((a,b)=>a+b.subtotal,0).toFixed(2)}`);
  lines.push('');
  lines.push('Please confirm availability and delivery details. My details:');
  lines.push('Name:');
  lines.push('Phone:');
  lines.push('Delivery address:');
  lines.push('');
  lines.push('Thank you!');
  return encodeURIComponent(lines.join('\n'));
}

/* Order button */
document.getElementById('orderOnWhatsApp').addEventListener('click', () => {
  const msg = buildWhatsAppMessage();
  if(!msg){
    alert('Please select at least one item and quantity before ordering.');
    return;
  }
  const url = `https://wa.me/${PHONE}?text=${msg}`;
  window.open(url, '_blank');
});

/* Floating quick chat */
document.getElementById('fab').addEventListener('click', () => {
  const quick = encodeURIComponent('Hello Amante Fishes! I have a question about availability and delivery.');
  window.open(`https://wa.me/${PHONE}?text=${quick}`, '_blank');
});

/* Clear all selections */
document.getElementById('clearAll').addEventListener('click', () => {
  if(!confirm('Clear all selected items?')) return;
  cartState = {};
  saveCart();
  // re-render active section to clear UI inputs
  const activeBtn = document.querySelector('.tab-btn.active');
  const idx = activeBtn ? Number(activeBtn.dataset.idx) : 0;
  renderSection(idx);
  updateSummary();
});

/* Keep summary live as user types (also useful if inputs are created after switching tabs) */
document.addEventListener('input', (e) => {
  if(e.target && (e.target.matches('.qty') || e.target.matches('.variant-select'))) updateSummary();
});

/* Render initial first section and ensure UI matches saved cart */
renderSection(0);
</script>
</body>
</html>

